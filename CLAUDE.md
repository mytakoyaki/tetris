# CLAUDE.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリのコードを扱う際のガイダンスを提供します。

## 🚫 実装時の制約

### 技術的制約
- **PC専用設計**: モバイル対応は一切行わない
- **キーボード操作**: マウス・タッチ操作は実装しない
- **画面サイズ**: 1200px以上の大画面専用
- **ブラウザ**: モダンブラウザ（Chrome, Firefox, Safari, Edge最新版）のみ対応
- **オフライン動作**: 外部API・通信機能は実装しない
- **ローカルストレージ**: データ保存はブラウザ内のみ

### デザイン制約
- **カラーパレット**: 深いグレー（#1a1a1a, #2d2d2d）、ネオン（#00ff88）、金色（#ffd700）を基本とする
- **フォント**: 'Segoe UI'（基本）、'Consolas'（数値）を固定使用
- **レイアウト**: 3エリア構成（横向き）または縦積み構成（縦向き）のみ
- **アニメーション**: CSS transforms、cubic-bezier、GPU加速を優先使用

### ゲームプレイ制約
- **テトリミノ**: 標準7種類（I, O, T, S, Z, J, L）のみ使用
- **フィールドサイズ**: 10×20グリッド固定
- **レベルシステム**: 30秒ごと自動レベルアップ（最大30）
- **フィーバーモード**: 20ブロック設置で発動、30秒間固定
- **段位システム**: 14段階固定（無段〜永世名人）

### パフォーマンス制約
- **フレームレート**: 60fps保証必須
- **メモリ使用量**: 適切なクリーンアップ処理必須
- **フィーバーモード**: パーティクル数8個以下、軽量アニメーション
- **GPU加速**: CSS transforms、will-change活用必須

## 🔄 開発フェーズ計画

### Phase 4（オンライン対応：2-3ヶ月）

#### 4.1 Firebase統合（1-2週間）
- Firebaseプロジェクト作成・設定
- 認証システム（匿名・メール認証）
- Realtime Database設定
- Firebase Hosting設定

#### 4.2 基本的なオンライン機能（2-3週間）
- ユーザー認証（ログイン・ログアウト）
- データ同期（スコア・実績・統計情報）
- グローバルランキング
- 段位別ランキング

#### 4.3 データ管理システム（1-2週間）
- ローカル・クラウド同期
- 競合解決・データ整合性
- 自動バックアップ機能
- データ検証・不正検出

### Phase 5（マルチプレイヤー機能：3-4ヶ月）

#### 5.1 リアルタイム対戦基盤（2-3週間）
- WebSocket接続・リアルタイム通信
- ルーム管理（作成・参加・退出）
- プレイヤーマッチング
- 接続管理（切断・再接続）

#### 5.2 1対1対戦システム（3-4週間）
- ゲーム状態同期
- 対戦UI・相手情報表示
- 勝利条件・結果判定
- 観戦機能

#### 5.3 トーナメントシステム（2-3週間）
- 自動トーナメント（段位別）
- 賞品システム（仮想通貨・称号・アバター）
- トーナメント履歴
- 通知システム

### Phase 6（ソーシャル機能：2-3ヶ月）

#### 6.1 フレンドシステム（2-3週間）
- フレンド管理（追加・削除・検索）
- フレンドランキング
- フレンド対戦
- フレンド通知

#### 6.2 コミュニティ機能（2-3週間）
- ゲーム内チャット
- リプレイ共有
- カスタムルール作成
- コミュニティランキング

#### 6.3 プロフィールシステム（1-2週間）
- 詳細ユーザープロフィール
- 統計分析・グラフ表示
- アバターシステム
- 称号システム

### Phase 7（高度な機能：3-4ヶ月）

#### 7.1 リプレイシステム（2-3週間）
- プレイ記録・再生
- 分析ツール・改善提案
- リプレイ共有・公開

#### 7.2 カスタマイズ機能（2-3週間）
- テーマシステム・カラーテーマ
- キーバインドカスタマイズ
- UIカスタマイズ
- サウンド設定

#### 7.3 アクセシビリティ（1-2週間）
- 色覚サポート
- 音声ガイド
- 完全キーボード操作
- フォントサイズ調整

### Phase 8（最適化・拡張：2-3ヶ月）

#### 8.1 パフォーマンス最適化（1-2週間）
- コード最適化
- ネットワーク最適化
- キャッシュ戦略
- CDN活用

#### 8.2 セキュリティ強化（1-2週間）
- データ暗号化
- 不正検出
- レート制限
- セキュリティ監査

#### 8.3 分析・監視（1週間）
- ユーザー分析
- パフォーマンス監視
- エラー追跡
- フィードバックシステム

## 📝 フェーズ完了後の作業

### 1. 成果記録（log.md）
各フェーズ完了後、以下の内容を`log.md`に記録する：

```markdown
## Phase X 完了報告

### 完了日
YYYY-MM-DD

### 実装内容
- 機能A: 詳細説明
- 機能B: 詳細説明
- 機能C: 詳細説明

### 技術的成果
- 新技術・ライブラリの導入
- パフォーマンス改善
- セキュリティ強化

### 課題・改善点
- 発見された問題
- 今後の改善予定

### 次のフェーズへの準備
- Phase X+1 の準備状況
- 必要な調査・検討事項
```

### 2. CLAUDE.md進捗更新
- 完了したフェーズの進捗状況を更新
- 新たに発見された制約や要件を追加
- 次のフェーズの詳細化

### 3. リモートリポジトリへのプッシュ
```bash
# 変更をステージング
git add .

# コミット
git commit -m "Phase X 完了: [実装内容の要約]"

# testブランチにプッシュ（Phase 4以降の開発用）
git push origin test

# タグ付け（オプション）
git tag -a v1.X.0 -m "Phase X 完了版"
git push origin v1.X.0
```

**注意**: Phase 4以降の開発は`test`ブランチで行い、安定版確認後に`main`ブランチにマージする。

## 🛠️ 開発コマンド

```bash
# 開発サーバー起動
python -m http.server 8000
# または
npx serve .

# テスト: ブラウザでの手動テスト（Chrome, Firefox, Safari, Edge）
```

## 📋 実装時の注意事項

### コード品質
- **命名規則**: 明確で一貫した命名
- **コメント**: 必要最小限、意図を説明
- **拡張性**: 新機能追加に対応可能な構造
- **テスト**: 各機能の動作確認必須

### データ管理
- **バックアップ**: 重要なデータの定期的バックアップ
- **バージョン管理**: データ構造の変更履歴管理
- **移行処理**: 旧データから新データへの移行
- **整合性チェック**: データの整合性確認

### セキュリティ
- **入力検証**: すべてのユーザー入力を検証
- **認証**: 適切な認証・認可処理
- **暗号化**: 機密データの暗号化
- **監査**: セキュリティログの記録

### パフォーマンス
- **最適化**: 継続的なパフォーマンス最適化
- **監視**: パフォーマンス指標の監視
- **スケーリング**: 負荷増加への対応
- **キャッシュ**: 効率的なキャッシュ戦略

---

**最終更新**: 2024年12月
**バージョン**: 2.1.0
**対象フェーズ**: Phase 4以降
