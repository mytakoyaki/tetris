# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要

**ClaudeTetris** - テトリス初心者をターゲットにした、革新的なポイントシステムとフィーバーモードを持つWebベースのテトリスゲーム。モダンブラウザ向けにHTML5、CSS3、JavaScript（ES6+）で構築。

## プロジェクトアーキテクチャ

### コアゲームメカニクス
- **ポイントシステム**: テトリミノ設置1回につき10ポイント獲得、戦略的優位性に使用可能
- **ブロック交換**: 30ポイント消費で現在落下中のブロックを交換（Eキー）
- **フィーバーモード**: 30回テトリミノ設置毎に発動、20秒間の特別効果:
  - 無料無制限ブロック交換
  - 全スコア2倍ボーナス
- **ホールドシステム**: 標準テトリスのホールド機能（Cキー）

### ゲーム構造
- **ゲームフィールド**: クラシックテトリスルールに従う10x20グリッド
- **テトリミノタイプ**: 標準7種類（I, O, T, S, Z, J, L）
- **UIレイアウト**: 3エリア構成:
  - 左: HOLD表示、フィーバーゲージ
  - 中央: ゲームフィールド
  - 右: SCORE、POINTS、NEXTブロック

### 操作方法
- 矢印キー: 移動（左/右/ソフトドロップ）と回転（上）
- スペース: ハードドロップ
- C: ホールド機能
- E: NEXTブロック交換（独自機能）

## 開発コマンド

バニラWebプロジェクトのため、ビルドシステムは不要:

```bash
# 開発
# index.htmlをブラウザで直接開くか、ローカルサーバーを使用:
python -m http.server 8000
# または
npx serve .

# テスト
# ブラウザでの手動テスト（Chrome, Firefox, Safari, Edge）
```

## ファイル構造（作成予定）

```
/
├── index.html          # 3エリアレイアウトのメインゲームページ
├── style.css          # ゲームスタイリングと視覚効果
├── script.js          # メインゲームロジックと状態管理
├── js/
│   ├── tetrominos.js  # テトリミノ定義とロジック
│   ├── gameField.js   # ゲームフィールド管理
│   ├── pointSystem.js # ポイント獲得と交換システム
│   ├── feverMode.js   # フィーバーモードメカニクス
│   └── ui.js          # UI更新と表示ロジック
└── readme.txt         # プロジェクト仕様書（日本語）
```

## ゲーム状態とロジック

### 主要ゲーム状態
- **スタート画面**: タイトルとSTART GAMEボタン
- **プレイ中**: 全メカニクスが有効なメインゲーム
- **フィーバーモード**: 20秒間の特別強化ゲームプレイ
- **ゲームオーバー**: 最終スコア表示とPLAY AGAINオプション

### スコア計算
- 1ライン: 100点
- 2ライン: 300点
- 3ライン: 500点
- 4ライン（テトリス）: 800点
- フィーバーモード中は全スコア2倍

## 実装注意事項

- 仕様書要件に従う: ハードコード禁止
- 同名の関数/変数名を避ける
- 初心者向けゲームプレイに焦点、明確な視覚フィードバック
- モチベーション維持のためフィーバーモード進捗カウンター実装
- フィーバーモード中のボーナススコア表示
- モダンブラウザでの滑らかな60fps保証

## 視覚効果優先順位

1. フィーバーモード発動アニメーション（「FEVER!」表示）
2. ボーナススコア表示（「+200 (x2 BONUS!)」）
3. フィーバータイマー/ゲージ表示
4. ブロック交換コスト表示（「-30P」）
5. フィーバーモード中の背景エフェクト

## デザイン要件 - 高級感の追求

### カラーパレット
- **ベースカラー**: 深いグレー（#1a1a1a, #2d2d2d）とチャコール系
- **アクセントカラー**: エレガントなネオン（#00ff88, #ff6b6b, #4ecdc4）
- **プレミアム効果**: 金色グラデーション（#ffd700〜#ff8c00）をフィーバーモードに使用
- **テキスト**: 高コントラストの白（#ffffff）とソフトグレー（#cccccc）

### タイポグラフィ
- **メインフォント**: モダンサンセリフ（'Segoe UI', 'Arial', sans-serif）
- **数値表示**: モノスペースフォント（'Consolas', 'Monaco', monospace）
- **タイトル**: 太字でレタースペーシング調整（letter-spacing: 2px）
- **階層**: 明確なフォントサイズ差とウェイト差

### 視覚エフェクト
- **シャドウ**: 深い影効果（box-shadow: 0 8px 32px rgba(0,0,0,0.3)）
- **グラデーション**: 微細な線形グラデーション背景
- **ボーダー**: 1px細線とroundedコーナー（border-radius: 8px）
- **ホバー効果**: 滑らかなtransition（0.3s ease）
- **グロー**: フィーバーモード時の発光効果（box-shadow glow）

### レイアウト高級化
- **スペーシング**: 十分な余白（padding: 20px〜40px）
- **アライメント**: 完璧な中央揃えと均等配置
- **コンテナ**: 角丸とサブトルシャドウ付きカード設計
- **レスポンシブ**: 全画面サイズで美しい比率維持

### プレミアム要素
- **アニメーション**: 60fps滑らか（CSS transforms使用）
- **パーティクル**: フィーバーモード時の微細なキラキラ効果
- **プログレスバー**: グラデーション付き進捗表示
- **ボタン**: 立体感のある押下フィードバック
- **ローディング**: エレガントなスピナー/進捗アニメーション

---

# Tetrisアプリ開発仕様書 🎮 (最終版)

このドキュメントは、Claude Codeを使用してWebブラウザで動作するTetrisアプリを開発するための詳細仕様書です。

## 1. プロジェクト概要

- **プロジェクト名**: ClaudeTetris
- **コンセプト**: 「間口は広く、奥行きは深く」。初心者向けの革新的なアシスト機能と、上級者がやり込める奥深いゲームシステムを両立させる。
- **ターゲットプラットフォーム**: モダンなWebブラウザ (Chrome, Firefox, Safari, Edge)
- **使用技術スタック**:
  - HTML5
  - CSS3
  - JavaScript (ES6+)

## 2. 画面設計とUIレイアウト

ゲーム画面は主に3つのエリアで構成されます。

| 左エリア (情報) | 中央エリア (ゲーム) | 右エリア (情報) |
|---|---|---|
| HOLD ブロック表示 | ゲームフィールド (10x20グリッド) | SCORE 表示 |
| FEVER GAUGE (カウンター) |  | POINTS (所持ポイント) 表示 |
| LEVEL 表示 |  | NEXT ブロック表示 |

## 3. ゲームの基本仕様

### 3.1 ゲームフィールド
- **サイズ**: 10 (幅) x 20 (高さ) のグリッド

### 3.2 操作方法
- **← →**: 移動
- **↑**: 回転
- **↓**: ソフトドロップ
- **スペース**: ハードドロップ
- **C**: ホールド
- **E**: NEXTブロック交換

### 3.3 レベルシステム
- **レベルアップ**: 10ライン消すごとにレベルが1上昇し、ブロックの自然落下速度が速くなる

### 3.4 基本スコア計算
- **1ライン**: 100点
- **2ライン**: 300点
- **3ライン**: 500点
- **4ライン (Tetris)**: 800点

## 4. ゲームのコアメカニクス：ポイント＆エクスチェンジ

### 4.1 ポイントシステム

**ポイント獲得条件**:
- **ブロック設置**: 1ブロック固定につき +10ポイント
- **ソフトドロップボーナス**: ソフトドロップキーで実際に移動した行数 × 0.5ポイント（小数点切り捨て）
- **ハードドロップボーナス**: ハードドロップで実際に移動した行数 × 1ポイント
- **テクニカルボーナス**: T-Spin成功時などに追加ポイント

**重要な修正点**:
- ソフト/ハードドロップのポイントは「実際に落下させた距離」ではなく「キー操作で移動した距離」に基づく
- ソフトドロップは1行につき0.5ポイント、ハードドロップは1行につき1ポイントに調整

### 4.2 NEXTブロック交換 (エクスチェンジ)
- **機能**: 30ポイントを消費し、NEXTブロックを別のランダムなブロックに交換する
- **戦略性**: 不利なブロックを有利なブロックに変更可能

### 4.3 フィーバーモード
- **突入条件**: ブロックを累計で30個設置するごとに自動で発動
- **持続時間**: 20秒間
- **効果**:
  - エクスチェンジが無料＆無限になる
  - 全ての獲得スコアが2倍になる
  - BGMと背景が変化し、爽快感を演出する

## 5. 上級者向けやり込み要素

### 5.1 テクニカルボーナス
初心者向けの楽しさを阻害せず、熟練プレイヤーの挑戦意欲を刺激するためのスコア＆ポイントボーナス。

- **T-Spin**: Tブロックを特定の形でねじ込んでラインを消すと、大量のボーナススコアと追加ポイントを獲得
- **Back-to-Back**: テトリスやT-Spinを連続で成功させると、スコアにx1.5のボーナス倍率が付与される
- **パーフェクトクリア**: フィールド上のブロックを全て消すと、特大のボーナス

### 5.2 スキルアップ要素
- **コンボシステム**: 連続でラインを消すとボーナス倍率が増加
- **効率プレイ**: 最小の交換回数でハイスコアを目指す
- **タイムアタック**: 一定スコアに到達するまでの時間を競う

## 6. 実装における重要な設計思想

### 6.1 初心者への配慮
- **視覚的フィードバック**: 操作結果が即座に分かる明確なUI
- **ポイントシステム**: 失敗を補える救済メカニクス
- **段階的な難易度**: レベルアップによる自然な成長曲線

### 6.2 上級者への挑戦
- **テクニカル要素**: 深いスキル要求と高いスコアポテンシャル
- **戦略性**: ポイント管理とブロック交換の最適化
- **やり込み要素**: 多様なボーナスと達成目標

### 6.3 バランス設計
- **ポイント経済**: 獲得と消費のバランス調整
- **フィーバー頻度**: 適切な間隔での爽快感提供
- **難易度曲線**: 挫折せずに上達できる進行設計

## 7. 技術的な実装方針

### 7.1 パフォーマンス
- **60fps保証**: 滑らかなアニメーションとレスポンス
- **メモリ効率**: 適切なオブジェクト管理
- **ブラウザ互換性**: 主要ブラウザでの安定動作

### 7.2 コード品質
- **モジュール設計**: 機能別の明確な分離
- **可読性**: 明確な命名規則と適切なコメント
- **拡張性**: 新機能追加に対応可能な構造

### 7.3 ユーザビリティ
- **直感的操作**: 一般的なテトリス操作との一貫性
- **レスポンシブ**: 様々な画面サイズへの対応
- **アクセシビリティ**: 色覚特性への配慮とキーボード操作